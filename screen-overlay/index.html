<!doctype html>
<html>
<head>
  <meta charset="UTF-8" />
  <style>
    body { margin:0; pointer-events:none; font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; }
    #wrap {
      background: rgba(0,0,0,0.65);
      color: #fff;
      border-radius: 12px;
      padding: 12px 14px;
      display: flex;
      align-items: flex-start;
      gap: 12px;
      box-shadow: 0 0 20px rgba(0,0,0,.4);
      max-width: 380px;
    }
    #avatar {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      flex: 0 0 auto;
    }
    #text { margin: 0; white-space: pre-wrap; }
  </style>
</head>
<body>
  <div id="wrap" hidden>
    <img id="avatar" />
    <p id="text"></p>
  </div>

  <script>
    const avatar = document.getElementById('avatar');
    const textEl = document.getElementById('text');
    const wrap = document.getElementById('wrap');

    let lastTimestamp = '';

    async function tick() {
      const data = await window.overlay.getLatest();
      console.debug('[overlay] tick result', data);
      if (data && data.timestamp !== lastTimestamp) {
        console.log('[overlay] new data', data);
        lastTimestamp = data.timestamp;
        avatar.src = data.avatar || '';
        textEl.textContent = data.text;
        wrap.hidden = false;
        window.overlay.speak(data.text);
      }
      setTimeout(tick, 1000);
    }

    tick();
  </script>
</body>
</html> 